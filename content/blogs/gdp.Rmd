---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-9-20"
description: GDP # the title that will show up once someone gets to this page
draft: false
image: gdp.jpeg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: GDP # slug is the shorthand URL address... no spaces plz
title: GDP Analysis
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
library(lubridate)
```


In this section, we would like to explore some data sets related to GDP.


First, we load the data. 

```{r read_GDP_data}

UN_GDP_data  <-  read_excel(here::here("data", "gdp_data.xlsx"), # Excel filename
                sheet="Download-GDPconstant-USD-countr", # Sheet name
                skip=2) # Number of rows to skip

```


```{r reshape_GDP_data, echo=FALSE}

tidy_GDP_data  <-  UN_GDP_data %>%
                   clean_names()%>%
                  pivot_longer(cols =4:51, #columns 4 to 51
               names_to = "year",
               values_to = "value")%>%
               mutate(value = value / 10^9 ) 

tidy_GDP_data$year<-gsub("x","",as.character(tidy_GDP_data$year))
tidy_GDP_data$year <- as.numeric(tidy_GDP_data$year)

tidy_GDP_data1 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Final consumption expenditure"] <- "Final Consumption"

tidy_GDP_data2 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Household consumption expenditure (including Non-profit institutions serving households)"] <- "Household Expenditure"

tidy_GDP_data3 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="General government final consumption expenditure"] <- "Government Expenditure"

tidy_GDP_data4 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Gross fixed capital formation (including Acquisitions less disposals of valuables)"] <- "Gross Fixed Capital"

tidy_GDP_data5 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Exports of goods and services"] <- "Exports"

tidy_GDP_data6 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Imports of goods and services"] <- "Imports"

tidy_GDP_data7 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Gross Domestic Product (GDP)"] <- "GDP"

tidy_GDP_data8 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Agriculture, hunting, forestry, fishing (ISIC A-B)"] <- "ISIC A-B"

tidy_GDP_data9 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="a
Mining, Manufacturing, Utilities (ISIC C-E)"] <- "ISIC C-E"

tidy_GDP_data10 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Manufacturing (ISIC D)"] <- "ISIC D"

tidy_GDP_data11 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Construction (ISIC F)"] <- "ISIC F"

tidy_GDP_data12 <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Other Activities (ISIC J-P)"] <- "ISIC J-P"

tidy_GDP_data_final <- tidy_GDP_data$indicator_name[tidy_GDP_data$indicator_name=="Total Value Added"] <- "TVA"
              
glimpse(tidy_GDP_data_final)


# Let us compare GDP components for these 3 countries

country_list <- c("United States","India", "Germany" ) 
Indicator_list <- c("Gross capital formation","Exports", "Government Expenditure",
                    "Household Expenditure", "Imports")

GDP_data_new <- tidy_GDP_data %>% 
  filter(indicator_name %in% Indicator_list) %>% 
  filter(country== country_list )

```

Then, we produce a graph showing GDP components over time.


# GDP components over time

```{r graph1, echo=FALSE}
GDP_graph <- ggplot(GDP_data_new, aes(x=year, y=value, color = indicator_name, group = indicator_name)) +
  geom_line() +
  facet_wrap(~country) +
  theme_bw() +
  labs(title = "GDP components over time",
       subtitle = "In constant 2010 USD",
       y = "Billion US$",
       color = "Components of GDP") +
  scale_x_continuous(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  scale_y_continuous(breaks = c(0, 2500, 5000, 7500, 10000, 12500)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))

GDP_graph
```



# GDP components in three countries

Below is a GDP graph of GDP by country in Germany, India, and the United States. 

```{r gdp2, echo=FALSE, out.width="100%"}

knitr::include_graphics("/img/gdp2.png",error =FALSE)
```




# Findings
From this chart, we can see different dynamic among these three countries: 

- **Germany**: The majority of the German GDP comes from household expenditures. Capital formation and government expenditure have been quite constant over the time. However, since the year 2000, net exports have been rising and household expenditures have increased.
 
- **India**: Also in India, most of the GDP comes from the household expenditures. While government expenditure and net exports have been somewhat stable, the gross capital formation increased strongly from 2000 onwards, while the household expenditures decreased.
 
- **US**: All four components of the GDP look quite stable for the US. Yet, over the given time frame government expenditures have decreased by around 15%, and gross capital formation and household expenditures gained greater significance.
 
Differences: For all the observed countries, the household expenditures made up for the largest part of the GDP. In the end of the period, in Germany the government expenditures and capital formation where the same while in the US and India capital formation was higher than government expenditures. Germany also has significantly positive net exports, while India and the US had negative net exports.